{"ast":null,"code":"'use strict';\n\nvar once = require('once');\n\nvar helpers = require('./helpers');\n\nfunction map(values, iterator, extensions, done) {\n  // Allow for extensions to not be specified\n  if (typeof extensions === 'function') {\n    done = extensions;\n    extensions = {};\n  } // Handle no callback case\n\n\n  if (typeof done !== 'function') {\n    done = helpers.noop;\n  }\n\n  done = once(done); // Will throw if non-object\n\n  var keys = Object.keys(values);\n  var length = keys.length;\n  var count = length;\n  var idx = 0; // Return the same type as passed in\n\n  var results = helpers.initializeResults(values);\n  var exts = helpers.defaultExtensions(extensions);\n\n  if (length === 0) {\n    return done(null, results);\n  }\n\n  for (idx = 0; idx < length; idx++) {\n    var key = keys[idx];\n    next(key);\n  }\n\n  function next(key) {\n    var value = values[key];\n    var storage = exts.create(value, key) || {};\n    exts.before(storage);\n    iterator(value, key, once(handler));\n\n    function handler(err, result) {\n      if (err) {\n        exts.error(err, storage);\n        return done(err, results);\n      }\n\n      exts.after(result, storage);\n      results[key] = result;\n\n      if (--count === 0) {\n        done(err, results);\n      }\n    }\n  }\n}\n\nmodule.exports = map;","map":{"version":3,"sources":["C:/frontend/node_modules/now-and-later/lib/map.js"],"names":["once","require","helpers","map","values","iterator","extensions","done","noop","keys","Object","length","count","idx","results","initializeResults","exts","defaultExtensions","key","next","value","storage","create","before","handler","err","result","error","after","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AAEA,IAAIC,OAAO,GAAGD,OAAO,CAAC,WAAD,CAArB;;AAEA,SAASE,GAAT,CAAaC,MAAb,EAAqBC,QAArB,EAA+BC,UAA/B,EAA2CC,IAA3C,EAAiD;AAC/C;AACA,MAAI,OAAOD,UAAP,KAAsB,UAA1B,EAAsC;AACpCC,IAAAA,IAAI,GAAGD,UAAP;AACAA,IAAAA,UAAU,GAAG,EAAb;AACD,GAL8C,CAO/C;;;AACA,MAAI,OAAOC,IAAP,KAAgB,UAApB,EAAgC;AAC9BA,IAAAA,IAAI,GAAGL,OAAO,CAACM,IAAf;AACD;;AAEDD,EAAAA,IAAI,GAAGP,IAAI,CAACO,IAAD,CAAX,CAZ+C,CAc/C;;AACA,MAAIE,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYL,MAAZ,CAAX;AACA,MAAIO,MAAM,GAAGF,IAAI,CAACE,MAAlB;AACA,MAAIC,KAAK,GAAGD,MAAZ;AACA,MAAIE,GAAG,GAAG,CAAV,CAlB+C,CAmB/C;;AACA,MAAIC,OAAO,GAAGZ,OAAO,CAACa,iBAAR,CAA0BX,MAA1B,CAAd;AAEA,MAAIY,IAAI,GAAGd,OAAO,CAACe,iBAAR,CAA0BX,UAA1B,CAAX;;AAEA,MAAIK,MAAM,KAAK,CAAf,EAAkB;AAChB,WAAOJ,IAAI,CAAC,IAAD,EAAOO,OAAP,CAAX;AACD;;AAED,OAAKD,GAAG,GAAG,CAAX,EAAcA,GAAG,GAAGF,MAApB,EAA4BE,GAAG,EAA/B,EAAmC;AACjC,QAAIK,GAAG,GAAGT,IAAI,CAACI,GAAD,CAAd;AACAM,IAAAA,IAAI,CAACD,GAAD,CAAJ;AACD;;AAED,WAASC,IAAT,CAAcD,GAAd,EAAmB;AACjB,QAAIE,KAAK,GAAGhB,MAAM,CAACc,GAAD,CAAlB;AAEA,QAAIG,OAAO,GAAGL,IAAI,CAACM,MAAL,CAAYF,KAAZ,EAAmBF,GAAnB,KAA2B,EAAzC;AAEAF,IAAAA,IAAI,CAACO,MAAL,CAAYF,OAAZ;AACAhB,IAAAA,QAAQ,CAACe,KAAD,EAAQF,GAAR,EAAalB,IAAI,CAACwB,OAAD,CAAjB,CAAR;;AAEA,aAASA,OAAT,CAAiBC,GAAjB,EAAsBC,MAAtB,EAA8B;AAC5B,UAAID,GAAJ,EAAS;AACPT,QAAAA,IAAI,CAACW,KAAL,CAAWF,GAAX,EAAgBJ,OAAhB;AACA,eAAOd,IAAI,CAACkB,GAAD,EAAMX,OAAN,CAAX;AACD;;AAEDE,MAAAA,IAAI,CAACY,KAAL,CAAWF,MAAX,EAAmBL,OAAnB;AACAP,MAAAA,OAAO,CAACI,GAAD,CAAP,GAAeQ,MAAf;;AACA,UAAI,EAAEd,KAAF,KAAY,CAAhB,EAAmB;AACjBL,QAAAA,IAAI,CAACkB,GAAD,EAAMX,OAAN,CAAJ;AACD;AACF;AACF;AACF;;AAEDe,MAAM,CAACC,OAAP,GAAiB3B,GAAjB","sourcesContent":["'use strict';\r\n\r\nvar once = require('once');\r\n\r\nvar helpers = require('./helpers');\r\n\r\nfunction map(values, iterator, extensions, done) {\r\n  // Allow for extensions to not be specified\r\n  if (typeof extensions === 'function') {\r\n    done = extensions;\r\n    extensions = {};\r\n  }\r\n\r\n  // Handle no callback case\r\n  if (typeof done !== 'function') {\r\n    done = helpers.noop;\r\n  }\r\n\r\n  done = once(done);\r\n\r\n  // Will throw if non-object\r\n  var keys = Object.keys(values);\r\n  var length = keys.length;\r\n  var count = length;\r\n  var idx = 0;\r\n  // Return the same type as passed in\r\n  var results = helpers.initializeResults(values);\r\n\r\n  var exts = helpers.defaultExtensions(extensions);\r\n\r\n  if (length === 0) {\r\n    return done(null, results);\r\n  }\r\n\r\n  for (idx = 0; idx < length; idx++) {\r\n    var key = keys[idx];\r\n    next(key);\r\n  }\r\n\r\n  function next(key) {\r\n    var value = values[key];\r\n\r\n    var storage = exts.create(value, key) || {};\r\n\r\n    exts.before(storage);\r\n    iterator(value, key, once(handler));\r\n\r\n    function handler(err, result) {\r\n      if (err) {\r\n        exts.error(err, storage);\r\n        return done(err, results);\r\n      }\r\n\r\n      exts.after(result, storage);\r\n      results[key] = result;\r\n      if (--count === 0) {\r\n        done(err, results);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = map;\r\n"]},"metadata":{},"sourceType":"script"}