"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.processHasOneConnection = void 0;
const process_connections_1 = require("./process-connections");
const process_connections_v2_1 = require("./process-connections-v2");
function processHasOneConnection(field, model, modelMap, connectionDirective) {
    const otherSide = modelMap[field.type];
    const otherSideField = process_connections_v2_1.getConnectedFieldV2(field, model, otherSide, connectionDirective.name);
    const connectionFields = connectionDirective.arguments.fields || [];
    const isConnectingFieldAutoCreated = connectionFields.length === 0;
    if (!field.isList && !otherSideField.isList) {
        if (field.isNullable && (!otherSideField.isNullable || connectionFields.length === 0)) {
            return {
                kind: process_connections_1.CodeGenConnectionType.HAS_ONE,
                associatedWith: otherSideField,
                connectedModel: otherSide,
                isConnectingFieldAutoCreated,
                targetName: connectionFields[0] || process_connections_1.makeConnectionAttributeName(model.name, field.name),
            };
        }
        else {
            throw new Error("A hasOne relationship should be optional on the owning side and not optional on the owned side");
        }
    }
    else {
        throw new Error("A hasOne relationship should be 1:1, no lists");
    }
}
exports.processHasOneConnection = processHasOneConnection;
//# sourceMappingURL=process-has-one.js.map